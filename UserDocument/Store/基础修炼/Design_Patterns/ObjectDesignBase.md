# PHP对象与设计
> PHP对象与设计的基本概念与思想

## 面向对象与面向过程
### 职责
### 内聚

内聚（Cohesion）是一个模块内部各成分之间相关联程度的度量。理想情况下各组件职责清晰分工明确，如果代码间关联范围太广，维护就会很困难，因为需要在修改某部分代码的同时修改其他相关的代码。

内聚按强度从低到高有以下几种类型：
1. 偶然内聚: 如果一个模块的各成分之间毫无关系，则称为偶然内聚，也就是说模块完成一组任务，这些任务之间的关系松散，实际上没有什么联系。
2. 逻辑内聚: 几个逻辑上相关的功能被放在同一模块中，则称为逻辑内聚。如一个模块读取各种不同类型外设的输入。尽管逻辑内聚比偶然内聚合理一些，但逻辑内聚的模块各成分在功能上并无关系，即使局部功能的修改有时也会影响全局，因此这类模块的修改也比较困难。
3. 时间内聚: 如果一个模块完成的功能必须在同一时间内执行（如系统初始化），但这些功能只是因为时间因素关联在一起，则称为时间内聚。
4. 通信内聚:如果一个模块的所有成分都操作同一数据集或生成同一数据集，则称为通信内聚。
5. 顺序内聚 : 如果一个模块的各个成分和同一个功能密切相关，而且一个成分的输出作为另一个成分的输入，则称为顺序内聚。
1. 过程内聚: 构件或者操作的组合方式是，允许在调用前面的构件或操作之后，马上调用后面的构件或操作，即使两者之间没有数据进行传递。
1. 信息内聚: 模块完成多个功能，各个功能都在同一数据结构上操作，每一项功能有一个唯一的入口点。这个模块将根据不同的要求，确定该模块执行哪一个功能。由于这个模块的所有功能都是基于同一个数据结构（符号表），因此，它是一个信息内聚的模块。
1. 功能内聚: 模块的所有成分对于完成单一的功能都是必须的，则称为功能内聚。                                                

### 耦合
对象之间的耦合度就是对象之间的依赖性。指导使用和维护对象的主要问题是对象之间的多重依赖性。对象之间的耦合越高，维护成本越高。因此对象的设计应使类和构件之间的耦合最小。

当各部分代码紧密绑在一起时，就会产生紧密耦合，一个组件变化会迫使其他组件跟着变化。

### 正交
将职责相关的组件紧紧组合在一起，而与外界系统环境隔开，保持独立。

## 选择类

如何定义类的界限？模拟真实世界是一个比较简单的方法，例如定义person类，shop类等。但是这样子带来的坏处是一个类需要完成的事情越来越多。

**最好的办法**是让一个类只有一个主要的职责并且任务要尽量独立。可以把类的职责用多个词描述，最好不超过25个词。

## 多态

定义：一个公共接口后维护多个实现。

如果代码中存在大量条件语句，说明需要实现多态。但是需要注意的是多态并没有消除条件语句，只是把条件代码集中在一个地方。

PHP强制接口由抽象类定义，但是PHP没有强制限定类方法返回的数据类型，这样意味着不同的子类可以返回不同类型，但是我们应该要尝试让返回值保持一定，有利于客户端对子类的切换。

## 封装
定义：对客户端代码隐藏数据和功能。
实现方法：  最简单的是将属性定义为private或者protected;

封装在某种程度上可以说是面向对象编程的关键，我们的目标是使系统中每一部分都尽量独立，类和方法应当能够接收足够的信息来执行承担的任务，而这些任务要有明确的范围。


## 设计类

**为接口而不是实现来编程**

没有人在设计类的时候绝对正确，大部分人都需要不停修改代码，下面是4个说明代码需要检查的路标，如果出现这些问题说明类需要重构：

### 1. 代码重复
重复意味着紧密耦合，修改一个地方可能需要修改另一个，很可能这些代码应该在一个地方。

### 2. 类知道的太多
有的时候全局变量可以减少传递参数的麻烦，但是使用时要谨慎。让一个类知道它之外的领域的内容，会把类绑定在外部环境中，让它很难重用。

### 3. 万能的类
类实现功能太多的话，需要检查职责列表提取一个基类。

类职责过多会在创造子类时产生问题。

### 4. 条件语句
如果在一个类中频繁使用特定条件的判断，特别是在多个方法中出现的时候，说明需要吧类拆分成两个或者更多。